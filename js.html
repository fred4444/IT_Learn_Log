<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0,user-scalable=0" />
		<title>javascript</title>
		<style>
			.class___line_head {
				margin-left : 2em;
			}
			.class___code {
				color : yellow;
				background-color : black;
				line-height : 24px;
				font-size : 18px;
				vertical-align : bottom;
				white-space : nowrap;
			}
			.class___tab {
				display : inline-block;
				width : 4ex;
				overflow-x : hidden;
				line-height : 24px;
				font-size : 18px;
				vertical-align : bottom;
				white-space : pre-wrap;
			}
			.class___code_last_line {
				display : inline-block;
				white-space : nowrap;
			}
			.shell_instruction {
				color : yellow;
				background-color : black;
				font-weight : 800;
				padding : 4px;
			}
			section > p {
				padding-left : 2em;
				line-height : 180%;
			}
		</style>
		<script>
			convert_code_to_html = () => {
				let source = document.getElementById('id___textarea___input_source_code');
				let target = document.getElementById('id___textarea___output_html_code');
				let s = source.value;
				console.log(s);
				s = s.trim();
				s = s.replace(/\r/g, '');
				s = s.replace(/ /g, '&nbsp;');
				s = s.replace(/>/g, '&gt;');
				s = s.replace(/</g, '&lt;');
				s = s.replace(/\t/g, '<span class="class___tab">&#9;</span>');
				s = s.replace(/\n/g, '<br/>\n');
				s = s.replace(/\n/g, '\n\t');
				s += '<br/>';
				console.log(s);
				target.value = '<div class="class___code">\n\t' + s + '\n</div>';
			}
			window.onload = (e) => {
				let button = document.getElementById('id___button___convert_code_to_html');
				console.log(button);
				button.addEventListener('click', convert_code_to_html, false);
			}
		</script>
	</head>
	<body>
		<article>
			<header>
				<h3>javascript</h3>
				<p>
					//
				</p>
			</header>
			<section>
				<h3>代码转换</h3>
				<div>
					<textarea id="id___textarea___input_source_code">
					</textarea>
					<button id="id___button___convert_code_to_html">轉換</button>
					<textarea id="id___textarea___output_html_code">
					</textarea>
				</div>
			</section>
			<section>
				<h3>截取指定字节数长度的字符串, 若最后的字占多个字节时则取全此字不截断, 此时实际字节长度大于指定字节长度</h3>
				<div class="class___code">
					let sub = (s, l) =&gt; {<br/>
						<span class="class___tab">&#9;</span>let c, r = '', t;<br/>
						<span class="class___tab">&#9;</span>let i = 0 <br/>
						<span class="class___tab">&#9;</span>while(i &lt; l) {<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>c = s.codePointAt(r.length);<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>c = c.toString(16);<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>i += Math.ceil(c.length / 2);<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>r += String.fromCodePoint('0x' + c);<br/>
						<span class="class___tab">&#9;</span>}<br/>
						<span class="class___tab">&#9;</span>return r;<br/>
					}<br/>
					console.log(sub('𠮷1𠮷1𠮷1𠮷1𠮷1𠮷1', 6));<br/>
				</div>
			</section>
			<section>
				<h3>获取字符串字节长度数</h3>
				<div class="class___code">
					let get_bytes = (s) =&gt; {<br/>
						<span class="class___tab">&#9;</span>let c, r = '', t;<br/>
						<span class="class___tab">&#9;</span>let i = 0;<br/>
						<span class="class___tab">&#9;</span>while(r.length &lt; s.length) {<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>c = s.codePointAt(r.length);<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>c = c.toString(16);<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>i += Math.ceil(c.length / 2);<br/>
							<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>r += String.fromCodePoint('0x' + c);<br/>
						<span class="class___tab">&#9;</span>}<br/>
						<span class="class___tab">&#9;</span>return i;<br/>
					}<br/>
					console.log(get_bytes('𠮷1𠮷'));<br/>
				</div>
			</section>
			<section>
				<h3>轉換日期格式字符串</h3>
				<div class="class___code">
					//YYYY-MM-DD&nbsp;hh:mm:ss&nbsp;iiii<br/>
					//i&nbsp;is&nbsp;milliseconds<br/>
					//default&nbsp;pad&nbsp;is&nbsp;'&nbsp;'<br/>
					let get_date_str&nbsp;=&nbsp;function(date,&nbsp;format,&nbsp;pad)&nbsp;{<br/>
					<span class="class___tab">&#9;</span>let&nbsp;year&nbsp;=&nbsp;date.getFullYear();<br/>
					<span class="class___tab">&#9;</span>let&nbsp;month&nbsp;=&nbsp;date.getMonth()&nbsp;+&nbsp;1;<br/>
					<span class="class___tab">&#9;</span>let&nbsp;day&nbsp;=&nbsp;date.getDate();<br/>
					<span class="class___tab">&#9;</span>let&nbsp;hour&nbsp;=&nbsp;date.getHours();<br/>
					<span class="class___tab">&#9;</span>let&nbsp;minutes&nbsp;=&nbsp;date.getMinutes();<br/>
					<span class="class___tab">&#9;</span>let&nbsp;seconds&nbsp;=&nbsp;date.getSeconds();<br/>
					<span class="class___tab">&#9;</span>let&nbsp;milliseconds&nbsp;=&nbsp;date.getMilliseconds();<br/>
					<br/>
					<span class="class___tab">&#9;</span>let&nbsp;m&nbsp;=&nbsp;[/[Y]+/g,&nbsp;/[M]+/g,&nbsp;/[D]+/g,&nbsp;/[h]+/g,&nbsp;/[m]+/g,&nbsp;/[s]+/g,&nbsp;/[i]+/g];<br/>
					<span class="class___tab">&#9;</span>let&nbsp;p&nbsp;=&nbsp;[year,&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;minutes,&nbsp;seconds,&nbsp;milliseconds];<br/>
					<span class="class___tab">&#9;</span>let&nbsp;a,&nbsp;s&nbsp;=&nbsp;format;<br/>
					<span class="class___tab">&#9;</span>for&nbsp;(let&nbsp;i&nbsp;=&nbsp;0,&nbsp;l&nbsp;=&nbsp;m.length;&nbsp;i&nbsp;&lt;&nbsp;l;&nbsp;i++)&nbsp;{<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>a&nbsp;=&nbsp;s.match(m[i]);<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>if&nbsp;(a)&nbsp;{<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>a.forEach(function(v)&nbsp;{<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>let&nbsp;l&nbsp;=&nbsp;v.length;<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>let&nbsp;t&nbsp;=&nbsp;(p[i]&nbsp;+&nbsp;'').padStart(l,&nbsp;pad&nbsp;||&nbsp;'&nbsp;').substr(-l,&nbsp;l);<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>s&nbsp;=&nbsp;s.replace(v,&nbsp;t);<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>});<br/>
					<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>}<br/>
					<span class="class___tab">&#9;</span>}<br/>
					<span class="class___tab">&#9;</span>return&nbsp;s;<br/>
					}<br/>
					<br/>
					<br/>
					<br/>
					console.log(get_date_str(new&nbsp;Date(),&nbsp;'YYYY-MM-DD&nbsp;YY&nbsp;YYYY&nbsp;YYY&nbsp;YY',&nbsp;'0'));<br/>
					console.log(get_date_str(new&nbsp;Date(),&nbsp;'MM-YY年-DD号&nbsp;iii毫秒'));<br/>
					console.log(get_date_str(new&nbsp;Date(),&nbsp;'MM月YY年-DD号&nbsp;iii毫秒'));<br/>
					console.log(get_date_str(new&nbsp;Date(),&nbsp;'YYYY-MM-DD&nbsp;hh:mm:ss&nbsp;YY年'));<br/>
				</div>
			</section>
		</article>
	</body>
</html>
