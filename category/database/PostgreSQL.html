<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0,user-scalable=0" />
		<title>PostgreSQL</title>
		<style>
			* {
			}
			.shell_instruction {
				color : yellow;
				background-color : black;
				font-weight : 800;
				padding : 4px;
				margin-top : 4px;
				margin-bottom : 4px;
				display : inline-block;
			}
			section > p {
				padding-left : 2em;
				line-height : 180%;
			}
			.step {
				margin-left : -2em;
				font-weight : 900;
			}
			.class___tab {
				display : inline-block;
				width : 4ex;
				overflow-x : hidden;
				line-height : 24px;
				font-size : 18px;
				vertical-align : bottom;
				white-space : pre-wrap;
			}
		</style>
		<script>
		</script>
	</head>
	<body>
		<article>
			<header>
				<h3>PostgreSQL</h3>
				<div>
					<span class="class___tab"></span>some log with reference
					<br/>
					<span class="class___tab"></span><a target="_blank" href="https://www.postgresql.org/">PostgreSQL: The world's most advanced open source database</a>
					<br/>
					<span class="class___tab"></span><a target="_blank" href="http://www.postgres.cn/v2/document">中文文档</a>
					<br/>
					<span class="class___tab"></span><a target="_blank" href="https://www.postgresql.org/docs/12/limits.html">PostgreSQL: Documentation: 12: Appendix K. PostgreSQL Limits</a>
				</div>
			</header>
			<section>
				<h3>PostgreSQL JSON 处理</h3>
				<div>
					<a target="_blank" href="https://www.cnblogs.com/VicLiu/p/11940524.html">PostgreSQL JSON 处理 - VicLW - 博客园</a>
				</div>
			</section>
			<section>
				<h3>postgresql-portable</h3>
				<div>
					<span class="class___tab"></span>PostgreSQL Portable
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>PostgreSQLPortable is an open source database packaged as a portable app, so you can run a full PostgreSQL database on your iPod, USB flash drive, portable hard drive, etc. It has all the same features as PostgreSQL, plus, it leaves no personal information behind on the machine you run it on, so you can take it with you wherever you go.
					<br/>
					<span class="class___tab"></span>Features
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>No installation required. Simply download, extract and run!
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>Runs a complete PostgreSQL Server instance.
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>Does not require a local "postgres" user account or administrator privileges, works for any user.
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>Completely portable - runs off a USB, cloud drive (DropBox, iCloud drive,
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>Packaged in PortableApps.com format for easy integration.
					<br/>
					<span class="class___tab"></span>System Requirements
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>Microsoft Windows 10, 8, 7, Vista or XP.
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>PortableApps.com Platform (Optional)
					<br/>
					<span class="class___tab"></span><a target="_blank" href="https://github.com/garethflowers/postgresql-portable">postgresql-portable</a>
				</div>
			</section>
			<section>
				<h3>nodejs操作postgresql</h3>
				<div>
					<a target="_blank" href="https://www.npmjs.com/package/pg">npm pg</a>
					<a target="_blank" href="https://github.com/brianc/node-postgres">brianc/node-postgres: PostgreSQL client for node.js</a>
				</div>
			</section>
			<section>
				<h3>PostgreSQL开启远程连接</h3>
				<div>
					<span class="class___tab"></span>data_path表示数据库文件所在文件夹的路径即命令
					<span class="shell_instruction">initdb -D data_path</span>
					中的data_path
					<br/>
					<span class="class___tab"></span>新安装的PostgreSQL server默认情况下，只接受客户端从localhost(127.0.0.1)请求的连接. 
					<br/>
					<span class="class___tab"></span>开启远程连接需要修改
					<br/>
					<span class="class___tab"></span>data_path/postgresql.conf
					<br/>
					<span class="class___tab"></span>和
					<br/>
					<span class="class___tab"></span>data_path/pg_hba.conf
					<br/>
					<br/>
					<span class="class___tab"></span>在data_path/postgresql.conf文件中
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span><span class="shell_instruction">#listen_addresses = 'localhost'		# what IP address(es) to listen on;</span>
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>修改为
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span><span class="shell_instruction">listen_addresses = '*'				# what IP address(es) to listen on;</span>
					<br/>
					<span class="class___tab"></span><span class="class___tab"></span>其中#是注释的开始符号, listen_addresses = 'localhost'表示只监听从本机客户端发来的请求, listen_addresses = '*'表示监听客户端从任何ip地址发来的请求
					<br/>
					<br/>
					<span class="class___tab"></span>在data_path/pg_hba.conf文件中
					<div class="class___code">
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;"local"&nbsp;is&nbsp;for&nbsp;Unix&nbsp;domain&nbsp;socket&nbsp;connections&nbsp;only<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>local&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trust<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;IPv4&nbsp;local&nbsp;connections:<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>127.0.0.1/32<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>trust<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;IPv6&nbsp;local&nbsp;connections:<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>::1/128<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>trust<br/>
						<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>下面添加<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;所有的IPv4地址都可以受信访问,&nbsp;其中的/24表示子网掩码是24个二进制位,&nbsp;即192.168.1被子网掩码覆盖需要一致,&nbsp;只有最后的8个二进制位可以任意,&nbsp;即192.168.1.0-192.168.1.255均可访问<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>192.168.1.0/24<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>trust<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>或<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;所有的IPv4地址都可以使用所有合法的数据库用户名访问数据库,&nbsp;并提供加密的密码验证<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>192.168.1.0/24<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>md5<br/>
						<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>或<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;所有的IPv4地址都可以受信访问,&nbsp;其中的/0表示子网掩码是0个二进制位,&nbsp;没有需要一致的部分,&nbsp;即0.0.0.0-255.255.255.255均可访问<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>0.0.0.0/0<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>trust<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>或<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;所有的IPv4地址都可以使用所有合法的数据库用户名访问数据库,&nbsp;并提供加密的密码验证<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>0.0.0.0/0<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>md5<br/>
						<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>或<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;所有的IPv6地址都可以受信访问,&nbsp;其中的/0表示子网掩码是0个二进制位,&nbsp;没有需要一致的部分,&nbsp;即::0-ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff均可访问<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>::0/0<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>trust<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>或<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>#&nbsp;所有的IPv6地址都可以使用所有合法的数据库用户名访问数据库,&nbsp;并提供加密的密码验证<br/>
						<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>host<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>all<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>::0/0<span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span><span class="class___tab">&#9;</span>md5<br/>
					</div>
				</div>
			</section>
			<section>
				<h3>uninstall postgresql</h3>
				<div>
					<span class="class___tab"></span>如果是用rpm方式安装的则用rpm -e package_name 方式即可
					<br/>
					<span class="class___tab"></span>如果使用源码方式安装则在源码目录中运行
					<span class="shell_instruction">make uninstall</span>
					如果源代码目录已经删了，也可以重新展开、配置，然后
					<span class="shell_instruction">make uninstall</span>
				</div>
			</section>
			<section>
				<h3>in phone termux install with use</h3>
				<div>
					<span class="class___tab"></span>安装
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">pkg install postgresql</span>
					<br/>
					<br/>
					<span class="class___tab"></span>建立存放数据库数据文件的文件夹, 路径可以自行设定, 举例在~/database/postgresql/data/下
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">cd ~/</span>
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">mkdir -p ./database/postgresql/data</span>
					<br/>
					<span class="class___tab"></span>建立存放数据库日志文件的文件夹, 路径可以自行设定, 举例在~/database/postgresql/log/下
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">mkdir -p ./database/postgresql/log</span>
					<br/>
					<br/>
					<span class="class___tab"></span>指定数据库文件存放的文件夹
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">cd ~/database/postgresql/</span>
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">initdb -D ./data</span>
					<br/>
					<br/>
					<span class="class___tab"></span>启动数据库服务端并指定对应的日志文件路径
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">pg_ctl -D ./data -l ./log/logfile start</span>
					<br/>
					<span class="class___tab"></span>-D 后面指定数据库文件夹路径, -l 后面指定日志文件路径
					<br/>
					<br/>
					<span class="class___tab"></span>创建指定名称的数据库, 举例数据库名称为mytest
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">createdb mytest</span>
					<br/>
					<br/>
					<span class="class___tab"></span>启动客户端并链接到数据库服务端指定名称的数据库, 举例数据库名称为mytest
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">psql mytest</span>
					<br/>
					<span class="class___tab"></span>查看所有的数据库, 进入后输入\l
					<br/>
					<span class="class___tab"></span>\l[+] or \list[+] [ pattern ]
					<br/>
					<span class="class___tab"></span>列出服务器中的数据库并且显示它们的名称、拥有者、字符集编码以及访问特权。如果指定了pattern，则只列出名称匹配该模式的数据库。如果向命令名称追加+，则还会显示数据库的尺寸、默认表空间以及描述（尺寸信息只对当前用户能连接的数据库可用）。
					<br/>
					<span class="class___tab"></span>退出数据库客户端, 进入后输入\q
					<br/>
					<span class="class___tab"></span>\q or \quit
					<br/>
					<span class="class___tab"></span>退出psql程序。在一个脚本文件中，只有该脚本的执行会被终止。 
					<br/>
					<br/>
					<span class="class___tab"></span>关闭数据库服务端
					<br/>
					<span class="class___tab"></span><span class="shell_instruction">pg_ctl -D ./data stop</span>
					<br/>
					<span class="class___tab"></span>pg_ctl stop [-D datadir] [-m s[mart] | f[ast] | i[mmediate] ] [-W] [-t seconds] [-s]
					<br/>
					<span class="class___tab"></span>stop模式关闭运行在指定数据目录中的服务器。对-m选项可以选择三种不同的关闭方法。“Smart”模式等待所有客户端断开连接以及任何在线备份结束。如果该服务器是热备，一旦所有的客户端已经断开连接，恢复和流复制将被终止。“Fast”模式（默认）不会等待客户端断开连接并且将终止进行中的在线备份。所有活动事务都被回滚并且客户端被强制断开连接，然后服务器被关闭。“Immediate”模式将立刻中止所有服务器进程，而不是做一次干净的关闭。这中选择将导致下一次重启时进行一次崩溃恢复。
				</div>
			</section>
		</article>
	</body>
</html>
